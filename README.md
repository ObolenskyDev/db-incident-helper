# üêò Database Incident Helper

![Bash](https://img.shields.io/badge/Shell-Bash-4EAA25?style=flat&logo=gnu-bash)
![Python](https://img.shields.io/badge/Python-3.8%2B-3776AB?style=flat&logo=python)
![PostgreSQL](https://img.shields.io/badge/DB-PostgreSQL-336791?style=flat&logo=postgresql&logoColor=white)
![License](https://img.shields.io/badge/License-MIT-blue.svg)

–ù–∞–±–æ—Ä —É—Ç–∏–ª–∏—Ç –¥–ª—è –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –°–£–ë–î (PostgreSQL/MariaDB) –≤ Enterprise-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ. –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏—á–∏–Ω –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤ –∏–ª–∏ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

---

## üì∏ –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
*(–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã –Ω–∞ –∂–∏–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –ø–æ–∏—Å–∫ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤)*

![Execution Result](demo_run.png)

---

## üõ† –°–æ—Å—Ç–∞–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

### 1. `pg_health.sh`
–°–∫—Ä–∏–ø—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ ¬´–∑–¥–æ—Ä–æ–≤—å—è¬ª –∏–Ω—Å—Ç–∞–Ω—Å–∞ –ë–î.
* **Service Analysis**: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤ systemd (active/uptime).
* **Port Listener**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø–æ—Ä—Ç–æ–≤ (5432/3306) —á–µ—Ä–µ–∑ `ss`.
* **Resource Guard**: –ö–æ–Ω—Ç—Ä–æ–ª—å —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ `/var/lib/postgresql` –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∞–≤–∞—Ä–∏–π–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –°–£–ë–î.

### 2. `slow_query_parser.py`
–ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –∂—É—Ä–Ω–∞–ª–æ–≤ PostgreSQL –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è ¬´—Ç—è–∂–µ–ª—ã—Ö¬ª –∑–∞–ø—Ä–æ—Å–æ–≤.
* **Pattern Matching**: –ü–æ–∏—Å–∫ –∑–∞–ø—Ä–æ—Å–æ–≤, –ø—Ä–µ–≤—ã—à–∞—é—â–∏—Ö –∑–∞–¥–∞–Ω–Ω—ã–π –ø–æ—Ä–æ–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (SLA).
* **Top-N Reporting**: –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞ –∏–∑ —Å–∞–º—ã—Ö –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏–Ω–¥–µ–∫—Å–æ–≤.
* **Sandbox Mode**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–µ–º–æ-–ª–æ–≥–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞.

## üöÄ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
```bash
# –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–∞–∑—ã
sudo ./pg_health.sh
```

```bash
# –ü–æ–∏—Å–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ –º–µ–¥–ª–µ–Ω–Ω–µ–µ 2 —Å–µ–∫—É–Ω–¥ –≤ –ª–æ–≥–∞—Ö
python3 slow_query_parser.py /var/log/postgresql/postgresql-15-main.log 2000
```